---
import BaseLayout from '../../layouts/BaseLayout.astro';
import SideMenu from '../../components/SideMenu.astro';

const chapterMetaFiles = import.meta.glob('../posts/web/*/meta.json', { eager: true });

const chapters = Object.entries(chapterMetaFiles)
  .map(([path, mod]) => {
    const meta = (mod as any).default ?? mod;
    const folder = path.split('/').at(-2);

    return {
      folder,
      title: meta.title,
      order: Number(meta.order) || 0,
      posts: []
    };
  })
  .sort((a, b) => a.order - b.order);

const postFiles = import.meta.glob('../posts/web/**/*.md', { eager: true });

for (const [path, raw] of Object.entries(postFiles)) {
  const mod = raw as any;
  const chapterName = path.split('/').at(-2);

  const chapter = chapters.find(c => c.folder === chapterName);
  if (!chapter) continue;

  chapter.posts.push({
    url: mod.url,
    title: mod.frontmatter.title
  });
}
---

<BaseLayout pageTitle="Web Development">
    <div slot="left">
        <SideMenu chapters={chapters} />
    </div>

    <h2>Web разработка</h2>

    <p>Данный раздел посвящен web-разработке и всему, что крутится вокруг создания сайтов и web-приложений. 
    Здесь постепенно будет появляться материал от базовых принципов до более продвинутых вещей, которые обычно всплывают только тогда, когда уже поздно гуглить.</p>

    <p>Планируется разбор HTML, CSS, JavaScript, серверных технологий, особенностей работы браузера, сетевых протоколов и прочих мелочей, на которых держится весь интернет, даже если он порой ведёт себя как подвыпивший.</p>

</BaseLayout>